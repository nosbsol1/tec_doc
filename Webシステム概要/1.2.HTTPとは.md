# HTTP基礎


## なにこれ？







### HTTPとは  

クライアント（ブラウザなど）とWebサーバーの間で、さまざまなデータを転送するために使用するプロトコル（通信規約）のことです。
（Htmlだけではなく、画像、動画、PDFなど、コンピュータで扱えるデータなら何でも転送出来ます。）  

HTTPプロトコルの仕様は、IETFという標準化団体が策定しています。   
仕様文書（[原文](https://httpwg.org/specs/rfc7231.html)、[日本語訳](https://triple-underscore.github.io/rfc-others/RFC2616-ja.html#section-4)）  
[仕様文書(原文)](https://httpwg.org/specs/rfc7231.html)  
[仕様文書(日本語訳)](https://triple-underscore.github.io/rfc-others/RFC2616-ja.html#section-4)  


HTTPでは、HTTPメッセージと呼ばれる文字列データをやり取りして必要な情報を伝え合います。    
HTTPメッセージには以下の2種類があります。  
- HTTPリクエスト  
クライアントが送信してサーバーにアクションを起こさせる為のHTTPメッセージ  

- HTTPレスポンス  
HTTPリクエストに対するサーバーの回答であるHTTPメッセージ  

図  


メッセージの仕様（どこにどんな情報をどうやって記載するか）はHTTPプロトコルの仕様の1部として[規定](https://triple-underscore.github.io/rfc-others/RFC2616-ja.html#section-4)されています。  

以下それぞれのメッセージについて説明します。  

### HTTPリクエスト  
HTTPリクエストは、以下のような文字列になります。  
例  

```
GET / HTTP/1.1
Host: google.com
Accept: text/html,application/xhtml+xmlsigned-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: ja,en-US;q=0.9,en;q=0.8
Connection: keep-alive

```


HTTPリクエストは大まかに以下のブロックに分かれます。  
#### ・リクエストライン（1行目） 
```
POST / HTTP/1.1
```
の部分に当たります。  
ここは以下の要素で構成されています。  
図  
- メソッド  
  サーバーにリクエストの種類を伝えるために使用します。  
  情報が欲しいときはGET、登録をしたい場合はPOSTを指定、などの使い方をします。  
  詳細は別記事で解説します。  

- リクエスト対象  
  URLのドメイン名以降の部分が入ります。  

- バージョン  
  HTTPのバージョンが入ります。  
  大抵はHTTP/1.1が指定されます。  

#### ・HTTPヘッダー（2行目～空行まで）   
```
Accept: text/html,application/xhtml+xmlsigned-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: ja,en-US;q=0.9,en;q=0.8
Host: google.com
```

の部分に当たります。  
サーバーに補助的な情報を伝える目的で使われます。  
例えばレスポンスの言語を指定したり、Cookie（別記事で解説）を記載できます。  
1行につき1つの情報を`ヘッダー名: 値`形式で記載し、複数行で構成可能です。  
 
例えば以下のようなヘッダーがあります。  
- Host  
URLのホスト名が記載されます。  

- Cookie  

- User-Agent  


これらのヘッダーの種類もHTTPの仕様の一部としてとして[定義](https://httpwg.org/specs/rfc7231.html#request.header.fields)されています。  
ブラウザやWebサーバーはこの仕様に基づいて実装されています。  
例えば、ブラウザはCookieを送りたい場合Cookieヘッダーに記載しますし、サーバーアプリはCookie情報を取得したい場合Cookieヘッダー確認します。  


よく使われるヘッダーについては別記事で解説します。  


#### ・本文（空行から後ろ）  
```

```
の部分に当たります。 

ユーザーが入力した情報などを記載します。  
詳しくは別記事で解説します。  

データが無い場合は省略可能です。  


### HTTPレスポンス
HTTPリクエストに対する応答として、WebサーバーはHTTPレスポンスメッセージをブラウザに送信します。  
HTTPレスポンスにはHtmlなどのブラウザ側に返却したいコンテンツ情報が含まれています。  

HTTPレスポンスは、以下のような文字列になります。  
例  



図  

HTTPリクエストと同じく、HTTPレスポンスの構文もHTTPの仕様の一部として定義されています。
以下HTTPレスポンスの構造を簡単に説明します。

#### ・ステータスライン （1行目） 
```

```
の部分を指します。  

ステータスラインは以下の情報を持ちます。  

- プロトコルバージョン  
通常「HTTP/1.1」です。  

- ステータスコード  
HTTPリクエストがどのように処理されたを示す3桁の数字コードです。  
例えば以下のステータスコードがあります。  
  - 200  
  処理が正常に終了したことを示す。  

  - 301
  リダイレクトをする必要があることを示す。  
  この場合、ブラウザはレスポンスヘッダーの`Location`ヘッダーに記載されたURLに自動的に遷移する。  

  - 404  
  リクエストされたパスの対する処理が見つからなかったことを示す。 

301レスポンスのように、ステータスコードによってはブラウザが特定の動作をするものがあります。  

- 説明句 
ステータスコードに対する補足の情報を文字列として持ちます。  
どのような文字列でもよいのですが、ステータスコード毎に一般的に設定される文字列があります。  
例  
(200のとき): OK  
(301のとき): Moved Permanently  
(404のとき): Not Found  

#### ・レスポンスヘッダー（2行目～空行まで）    
リクエストと同じく、補助的な情報を伝える目的で使われます。  
記述の書式も同一です。（`ヘッダー名: 値`）

例えば以下のようなヘッダーがあります。  
- Date  


- Set-Cookie  

- Content-Length 


#### ・レスポンスボディ（空行から後ろ）  
ここに応答したい内容が入ります。  
Htmlファイルを返却したい場合は、Htmlファイルの内容が記述されています。  
404など、応答によっては本文が無いものもあります。  

図  


まとめると、リクエスト・レスポンスのどちらも以下の構造になります。  
ただしそれぞれ1行目の内容やヘッダーの種類が異なります。  

図  

以上が簡単なHTTPの説明になります。  
もう少し詳しい説明は別記事で行います。  


#### Webサーバーに対してHTTPリクエストを送信  
元の話に戻ると、ブラウザはWebサーバーのIPを確認後、HTTPリクエストを生成しWebサーバーに送信します。  
例として、googleサイトを開いた際のリクエストを添付します。    

```


```
Webサイトを表示する際、このようなHTTPリクエストの作成・送信処理をブラウザがやってくれているわけです。  





